sudo su
apt update
apt install -qy git runc bridge-utils
curl -sSL https://github.com/alexellis/containerd-arm/releases/download/v1.5.4/containerd-1.5.4-linux-armhf.tar.gz | sudo tar -xvz                                                    --strip-components=1 -C /usr/local/bin/
wget --output-document=/etc/systemd/system/containerd.service https://raw.githubusercontent.com/containerd/containerd/v1.5.4/containerd.service
systemctl enable containerd
systemctl start containerd.service
modprobe br_netfilter
sysctl net.bridge.bridge-nf-call-iptables=1
/sbin/sysctl -w net.ipv4.conf.all.forwarding=1
mkdir -p /opt/cni/bin
curl -sSL https://github.com/containernetworking/plugins/releases/download/v1.0.1/cni-plugins-linux-arm-v1.0.1.tgz | tar -xz -C /opt/cni/bin
curl -sLfS https://cli.openfaas.com | sh
source <(faas-cli completion --shell bash)
wget --output-document=/usr/local/bin/faasd https://github.com/openfaas/faasd/releases/download/0.14.2/faasd-armhf && chmod +x /usr/local/bin/faasd
export GOPATH=$HOME/go/
mkdir -p $GOPATH/src/github.com/openfaas
cd $GOPATH/src/github.com/openfaas
git clone https://github.com/openfaas/faasd.git
cd faasd/
faasd install

   24  cat /var/lib/faasd/secrets/basic-auth-password | faas-cli login -s
   25  cat /var/lib/faasd/secrets/basic-auth-password | faas-cli login -s

   26  cd
   27  faas-list
   28  faas
   29  clear
   30  faas list
   31  clear

cd
wget -qO- https://github.com/moby/buildkit/releases/download/v0.9.2/buildkit-v0.9.2.linux-arm-v7.tar.gz | tar -xz -C /usr/local/bin/ --strip-components=1
mkdir ~/openfaas && cd ~/openfaas
faas new hello-go --lang go --prefix juanidufourc
faas build -f hello-go.yml --shrinkwrap
mkdir ~/.docker && cd ~/.docker
touch config.json
export DOCKERHUB_USERNAME=juanidufourc
export DOCKERHUB_TOKEN=61d17d3b-05d0-481c-9d03-db94183fd65b
export DOCKER_AUTH=$(echo -n "$DOCKERHUB_USERNAME:$DOCKERHUB_TOKEN" | base64)
cat > ~/.docker/config.json << EOF
{
    "auths": {
        "https://index.docker.io/v1/": {
            "auth": "$DOCKER_AUTH"
        }
    }
}
EOF

cd ~/openfaas/
/usr/local/bin/buildkitd &
buildctl build \
    --frontend dockerfile.v0 \
    --local context=build/hello-go/ \
    --local dockerfile=build/hello-go/ \
    --output type=image,name=docker.io/juanidufourc/hello-go:latest,push=true
faas deploy -f hello-go.yml